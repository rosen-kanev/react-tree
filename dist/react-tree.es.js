var e=Object.defineProperty,t=Object.defineProperties,r=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,o=(t,r,n)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[r]=n,d=(e,t)=>{for(var r in t||(t={}))l.call(t,r)&&o(e,r,t[r]);if(n)for(var r of n(t))a.call(t,r)&&o(e,r,t[r]);return e},i=(e,n)=>t(e,r(n));import c,{createContext as s,useContext as u,useRef as f}from"react";const p=s({selected:null,focused:null,expanded:[],onItemSelect(){},renderLabel(){}});p.displayName="TreeContext";const m=e=>{const{selected:t,focused:r,expanded:n,onItemSelect:l,renderLabel:a}=u(p),o=e.nodes.length>0,s=o?n.includes(e.id):null;return c.createElement("li",{role:"treeitem",tabIndex:r===e.id?0:-1,"aria-expanded":s,"aria-selected":t===e.id||null,"data-id":`treeitem-${e.id}`},"function"==typeof a?a(d({isExpanded:s,isExpandable:o,toggleItem(){l(e.id,o)}},e)):c.createElement("div",{onClick:()=>l(e.id,o)},e.label),s&&o&&c.createElement("ul",{role:"group"},e.nodes.map((e=>c.createElement(m,i(d({},e),{key:e.id}))))))},b=(e,t)=>{const r=[];for(const n of e)r.push(n),t.includes(n.id)&&r.push(...b(n.nodes,t));return r};function x(e){var t=e,{nodes:r,selected:o,focused:s,onFocusChange:u,expanded:x,onExpandChange:y,onSelect:E,renderLabel:v}=t,g=((e,t)=>{var r={};for(var o in e)l.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(null!=e&&n)for(var o of n(e))t.indexOf(o)<0&&a.call(e,o)&&(r[o]=e[o]);return r})(t,["nodes","selected","focused","onFocusChange","expanded","onExpandChange","onSelect","renderLabel"]);const h=f(null),w=(e,t)=>{t&&y(x.includes(e)?x.filter((t=>t!==e)):x.concat(e)),u(e),E(e)},I=e=>{const t=b(r,x),n=t.findIndex((e=>e.id===s));let l=e?0:1;n>-1&&(l=e?n-1:n+1);const a=t[l];if(a){u(a.id);const e=h.current.querySelector(`[data-id="treeitem-${a.id}"]`);e.focus(),e.firstElementChild.scrollIntoView({block:"center"})}},k=e=>{const t=h.current.querySelector(`[data-id="treeitem-${e}"]`);return{treeItem:t,isExpandable:t.hasAttribute("aria-expanded"),isExpanded:"true"===t.getAttribute("aria-expanded")}},O=e=>{if(e){e.focus(),e.firstElementChild.scrollIntoView({block:"center"});const t=e.dataset.id.replace("treeitem-","");u(t)}};return c.createElement(p.Provider,{value:{selected:o,focused:s,expanded:x,onItemSelect:w,renderLabel:v}},c.createElement("ul",i(d({ref:h,role:"tree"},g),{onKeyDown:e=>{if(r.length&&!e.altKey&&!e.ctrlKey&&!e.metaKey)if("ArrowUp"===e.key)e.preventDefault(),I(!0);else if("ArrowDown"===e.key)e.preventDefault(),I(!1);else if("ArrowLeft"===e.key){e.preventDefault();const{treeItem:t,isExpandable:r,isExpanded:n}=k(s);r&&n?y(x.filter((e=>e!==s))):O(t.closest('[role="treeitem"]:not([tabindex="0"])'))}else if("ArrowRight"===e.key){e.preventDefault();const{treeItem:t,isExpandable:r,isExpanded:n}=k(s);r&&(n?O(t.querySelector('[role="treeitem"]')):y(x.concat(s)))}else if("Enter"===e.key||" "===e.key){e.preventDefault();const t=h.current.querySelector(`[data-id="treeitem-${s}"]`).hasAttribute("aria-expanded");w(s,t)}}}),r.map((e=>c.createElement(m,i(d({},e),{key:e.id}))))))}export default x;
