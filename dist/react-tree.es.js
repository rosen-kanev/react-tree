var e=Object.defineProperty,t=Object.defineProperties,r=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,d=(t,r,n)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[r]=n,o=(e,t)=>{for(var r in t||(t={}))a.call(t,r)&&d(e,r,t[r]);if(n)for(var r of n(t))l.call(t,r)&&d(e,r,t[r]);return e},i=(e,n)=>t(e,r(n));import c,{createContext as u,useContext as s,useState as f,useCallback as p,useRef as m}from"react";const b=u({selected:null,focused:null,expanded:[],onItemSelect(){},renderLabel(){}});b.displayName="TreeContext";const y=e=>{const{selected:t,focused:r,expanded:n,onItemSelect:a,renderLabel:l}=s(b),d=e.nodes.length>0,u=d?n.includes(e.id):null;return c.createElement("li",{role:"treeitem",tabIndex:r===e.id?0:-1,"aria-expanded":u,"aria-selected":t===e.id||null,"data-id":`treeitem-${e.id}`,"data-id-type":typeof e.id},"function"==typeof l?l(i(o({},e),{isExpanded:u,isExpandable:d,toggleItem(){a(e.id,d)}})):c.createElement("div",{onClick:()=>a(e.id,d)},e.label),u&&d&&c.createElement("ul",{role:"group"},e.nodes.map((e=>c.createElement(y,i(o({},e),{key:e.id}))))))},x=({value:e,defaultValue:t,onChange:r})=>{const[n,a]=f(t),l=void 0===e,d=l?n:e,o=p((e=>{const t="function"==typeof e?e(d):e;l&&a(t),r(t)}),[l,r,d]);return[d,o]},v=()=>{};function E(e){var t=e,{nodes:r,defaultFocused:d,focused:u,onFocusChange:s=v,defaultExpanded:f=[],expanded:p,onExpandChange:E=v,defaultSelected:g,selected:h,onSelect:k=v,renderLabel:w}=t,C=((e,t)=>{var r={};for(var d in e)a.call(e,d)&&t.indexOf(d)<0&&(r[d]=e[d]);if(null!=e&&n)for(var d of n(e))t.indexOf(d)<0&&l.call(e,d)&&(r[d]=e[d]);return r})(t,["nodes","defaultFocused","focused","onFocusChange","defaultExpanded","expanded","onExpandChange","defaultSelected","selected","onSelect","renderLabel"]);const I=m(null),[S,O]=x({defaultValue:void 0===d&&r.length>0?r[0].id:void 0,value:u,onChange:s}),[A,D]=x({defaultValue:f,value:p,onChange:E}),[j,L]=x({defaultValue:g,value:h,onChange:k}),P=(e,t)=>{t&&D(A.includes(e)?A.filter((t=>t!==e)):A.concat(e)),O(e),L(e)},V=e=>{const t=I.current.querySelectorAll('[role="treeitem"]');let r;for(let n=0;n<t.length;n++){if(0===t[n].tabIndex){r=e?t[n-1]:t[n+1];break}}if(r){const e=r.dataset.id.replace("treeitem-",""),t=r.dataset.idType;O("number"===t?Number(e):e),r.focus(),r.firstElementChild.scrollIntoView({block:"center"})}},q=e=>{const t=I.current.querySelector(`[data-id="treeitem-${e}"]`);return{treeItem:t,isExpandable:t.hasAttribute("aria-expanded"),isExpanded:"true"===t.getAttribute("aria-expanded")}},F=e=>{if(e){e.focus(),e.firstElementChild.scrollIntoView({block:"center"});const t=e.dataset.id.replace("treeitem-",""),r=e.dataset.idType;O("number"===r?Number(t):t)}};return c.createElement(b.Provider,{value:{selected:j,focused:S,expanded:A,onItemSelect:P,renderLabel:w}},c.createElement("ul",i(o({ref:I,role:"tree"},C),{onKeyDown:e=>{if(r.length&&!e.altKey&&!e.ctrlKey&&!e.metaKey)if("ArrowUp"===e.key)e.preventDefault(),V(!0);else if("ArrowDown"===e.key)e.preventDefault(),V(!1);else if("ArrowLeft"===e.key){e.preventDefault();const{treeItem:t,isExpandable:r,isExpanded:n}=q(S);r&&n?D(A.filter((e=>e!==S))):F(t.closest('[role="treeitem"]:not([tabindex="0"])'))}else if("ArrowRight"===e.key){e.preventDefault();const{treeItem:t,isExpandable:r,isExpanded:n}=q(S);r&&(n?F(t.querySelector('[role="treeitem"]')):D(A.concat(S)))}else if("Enter"===e.key||" "===e.key){e.preventDefault();const t=I.current.querySelector(`[data-id="treeitem-${S}"]`).hasAttribute("aria-expanded");P(S,t)}}}),r.map((e=>c.createElement(y,i(o({},e),{key:e.id}))))))}export default E;
